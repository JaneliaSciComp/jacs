<?xml version="1.0" encoding="UTF-8"?>

<!--
  ~ Copyright (c) 2010-2011, J. Craig Venter Institute, Inc.
  ~
  ~ This file is part of JCVI VICS.
  ~
  ~ JCVI VICS is free software; you can redistribute it and/or modify it
  ~ under the terms and conditions of the Artistic License 2.0.  For
  ~ details, see the full text of the license in the file LICENSE.txt.  No
  ~ other rights are granted.  Any and all third party software rights to
  ~ remain with the original developer.
  ~
  ~ JCVI VICS is distributed in the hope that it will be useful in
  ~ bioinformatics applications, but it is provided "AS IS" and WITHOUT
  ~ ANY EXPRESS OR IMPLIED WARRANTIES including but not limited to
  ~ implied warranties of merchantability or fitness for any particular
  ~ purpose.  For details, see the full text of the license in the file
  ~ LICENSE.txt.
  ~
  ~ You should have received a copy of the Artistic License 2.0 along with
  ~ JCVI VICS.  If not, the license can be obtained from
  ~ "http://www.perlfoundation.org/artistic_license_2_0."
  -->

<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="org.janelia.it.jacs.model.tasks"
                   default-access="property"
                   default-lazy="false"
                   auto-import="true"
                   default-cascade="none" >
    <class name="Task"
           polymorphism="implicit"
           abstract="true"
           table="task"
           lazy="false">
        <id name="objectId" access="field" column="task_id" type="java.lang.Long">
            <generator class="org.janelia.it.jacs.model.TimebasedIdentifierGenerator" />
        </id>
        <discriminator column="subclass"
                       type="java.lang.String"
                       force="false"
                       insert="true"
                       not-null="true" />
        <set name="inputNodes" table="task_input_node" cascade="all" lazy="true">
            <key foreign-key="task_input_node_fk_task"
                column="task_id">
            </key>
            <many-to-many class="org.janelia.it.jacs.model.user_data.Node"
                    foreign-key="task_input_node_fk_node">
                    <column name="node_id" index="task_input_node_fk_node"/>
            </many-to-many>
        </set>
        <set name="outputNodes" cascade="all" inverse="true" lazy="true">
            <key column="task_id" />
            <one-to-many class="org.janelia.it.jacs.model.user_data.Node" />
        </set>
        <set name="messages" cascade="all" lazy="true">
            <key column="task_id" />
            <one-to-many class="org.janelia.it.jacs.model.tasks.TaskMessage" />
        </set>
        <property name="parentTaskId" type="java.lang.Long" column="parent_task_id" not-null="false"/>
        <property name="taskName" type="string" column="task_name" not-null="true"/>
        <property name="owner" type="string" column="task_owner" not-null="true"/>
        <property name="jobName" type="java.lang.String">
           <column name="job_name" sql-type="varchar(255)"/>
        </property>
        <property name="taskDeleted" type="boolean" column="task_deleted_flag" not-null="false"/>
        <property name="expirationDate" type="date" column="expiration_date" not-null="false"/>
        <property name="taskNote" type="string" column="task_note" not-null="false"/>
        <list name="events" cascade="all" table="task_event" lazy="true" inverse="false">
            <key column="task_id" foreign-key="task_event_fk_task"/>
            <index column="event_no"/>
            <one-to-many class="Event"/>
        </list>

        <set name="taskParameterSet" cascade="all" lazy="false" inverse="false">
            <key column="task_id" foreign-key="task_parameters_fk_task"/>
            <one-to-many class="TaskParameter"/>
        </set>
        
    </class>
    <subclass name="org.janelia.it.jacs.model.tasks.SessionTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="sessionTask">
    </subclass>
    <subclass name="org.janelia.it.jacs.model.tasks.utility.UploadFileTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="uploadFileTask">
    </subclass>
    <subclass name="org.janelia.it.jacs.model.tasks.utility.CopyFileTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="copyFileTask">
    </subclass>
    <subclass name="org.janelia.it.jacs.model.tasks.utility.FtpFileTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="ftpFileTask" abstract="false">
    </subclass>
    <subclass name="org.janelia.it.jacs.model.tasks.blast.CreateBlastDatabaseTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="createBlastDBTask" abstract="false">
        <subclass name="org.janelia.it.jacs.model.tasks.blast.CreateRecruitmentBlastDatabaseTask"
                  discriminator-value="createRecruitmentBlastDBTask" abstract="false"/>
    </subclass>
    <subclass name="org.janelia.it.jacs.model.tasks.blast.CreateMpiBlastDatabaseTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="createMpiBlastDBTask">
    </subclass>

    <!--<subclass name="org.janelia.it.jacs.model.tasks.metageno.MetaGenoPersistAnnoSqlTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="metaGenoPersistAnnoSqlTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.metageno.MetaGenoPersistOrfSqlTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="metaGenoPersistOrfSqlTask">-->
    <!--</subclass>-->
    <!-- -->
    <!--<subclass name="org.janelia.it.jacs.model.tasks.utility.UploadFastqDirectoryTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="uploadFastqDirectoryTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.rnaSeq.TophatTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="tophatTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.utility.UploadSamFileTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="uploadSamFileTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.utility.UploadGtfFileTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="uploadGtfFileTask">-->
    <!--</subclass>-->
    <!-- -->
    <!--<subclass name="org.janelia.it.jacs.model.tasks.utility.UploadGenezillaIsoFileTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="uploadGenezillaIsoFileTask">-->
    <!--</subclass>-->

     <!--<subclass name="org.janelia.it.jacs.model.tasks.rnaSeq.CufflinksTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="cufflinksTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.SignalpTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="signalpTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.eukAnnotation.EAPTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="eapTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.EvidenceModelerTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="evidenceModelerTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.sift.SiftProteinSubstitutionTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="siftProteinSubstitution">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.ExonerateTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="exonerateTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.AugustusTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="augustusTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.TrfTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="trfTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.GenezillaTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="genezillaTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.RepeatMaskerTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="repeatMaskerTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.InterProScanTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
                  <!--discriminator-value="interProScanTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.PrositeScanTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="prositeScanTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.TargetpTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="targetpTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.TmhmmTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="tmhmmTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.FgeneshTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="fgenesTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.CddSearchTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="cddsearchTask">-->
    <!--</subclass>-->
    <!-- -->
    <!--<subclass name="org.janelia.it.jacs.model.tasks.rnaSeq.RnaSeqPipelineTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="rnaSeqPipeline">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.rnaSeq.GtfToPasaIntegrationTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="gtfToPasaIntegration">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.MuscleTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="muscleTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.hmmer3.HMMER3Task" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="hmmer3Task">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.Clustalw2Task" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="clustalw2Task">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.Legacy2BsmlTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="legacy2BsmlTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.JaccardTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="jaccardTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.JocsTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="jocsTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.GenericServiceTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="genericServiceTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.rnaSeq.UploadRnaSeqReferenceGenomeTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
              <!--discriminator-value="uploadRnaSeqReferenceGenomeTask">-->
    <!--</subclass>-->

    <!--<subclass name="org.janelia.it.jacs.model.tasks.tools.Fasta2BsmlTask" extends="org.janelia.it.jacs.model.tasks.Task"-->
                 <!--discriminator-value="fasta2BsmlTask">-->
    <!--</subclass>-->
    <!-- -->
    <subclass name="org.janelia.it.jacs.model.tasks.utility.ContinuousExecutionTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="ceTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.fileDiscovery.FileDiscoveryTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="fileDiscoveryTask">
    </subclass>
    
    <subclass name="org.janelia.it.jacs.model.tasks.fileDiscovery.MCFODataPipelineTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="mcfoDataPipelineTask">
    </subclass>
    
    <subclass name="org.janelia.it.jacs.model.tasks.fileDiscovery.MCFOSamplePipelineTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="mcfoSamplePipelineTask">
    </subclass>
    
    <subclass name="org.janelia.it.jacs.model.tasks.fileDiscovery.MCFOSeparationPipelineTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="mcfoSeparationPipelineTask">
    </subclass>
    
    <subclass name="org.janelia.it.jacs.model.tasks.fileDiscovery.EntityViewCreationTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="viewCreationTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.fly.FlyScreenPatternAnnotationTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="flyScreenPatternAnnotationTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.fly.MaskSampleAnnotationTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="maskSampleAnnotationTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.fileDiscovery.FileTreeLoaderPipelineTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="fileTreeLoaderPipelineTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.maskSearch.MaskSearchTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="maskSearchTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.annotation.CompartmentAnnotation3DTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="compartmentAnnotation3DTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.LsTestTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="lsTestTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.SageLoaderTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="sageLoaderTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.BZipTestTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="bzipTestTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.ScalityMigrationTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="scalityMigrationTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.JFSExportTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="jfsExportTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.VLCorrectionTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="vlCorrectionTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.GenericTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="genericTask">
    </subclass>

    <subclass name="org.janelia.it.jacs.model.tasks.validation.ValidationTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="validationTask"/>

    <subclass name="org.janelia.it.jacs.model.tasks.tiledMicroscope.SwcImportTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="swcImportTask"/>

    <subclass name="org.janelia.it.jacs.model.tasks.geometricSearch.GeometricIndexTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="geometricIndexTask"/>

    <subclass name="org.janelia.it.jacs.model.tasks.utility.LSMProcessingTask" extends="org.janelia.it.jacs.model.tasks.Task"
              discriminator-value="lsmProcessingTask">
    </subclass>

    <class name="Event"
           table="task_event">
        <composite-id>
            <key-many-to-one name="task"
                          class="Task"
                          column="task_id"/>
            <key-property name="eventIndex"
                          type="int"
                          column="event_no"/>
        </composite-id>
        <many-to-one name="task"
                     class="Task"
                     cascade="all"
                     column="task_id"
                     insert="false"
                     update="false"
                     not-null="true"/>
        <property name="description"
                  type="string"
                  access="property"
                  column="description"
                  not-null="false"
                  generated="never"
                  update="true"
                  insert="true"
                  lazy="false"
                  optimistic-lock="false"
                  unique="false"/>

        <property name="timestamp"
                  type="timestamp"
                  access="property"
                  column="event_timestamp"
                  not-null="true"
                  generated="never"
                  update="false"
                  insert="true"
                  lazy="false"
                  optimistic-lock="false"
                  unique="false"/>

        <property name="eventType"
                  type="string"
                  access="property"
                  column="event_type"
                  not-null="true"
                  generated="never"
                  update="true"
                  insert="true"
                  lazy="false"
                  optimistic-lock="false"
                  unique="false"/>

    </class>


    <class name="TaskParameter"
           table="task_parameter">
        <composite-id>
            <key-many-to-one name="task" class="Task" column="task_id"/>
            <key-property name="name" type="string" column="parameter_name"/>
        </composite-id>
        <property name="value"
                  type="string"
                  access="property"
                  column="parameter_value"
                  not-null="false"
                  generated="never"
                  update="true"
                  insert="true"
                  lazy="false"
                  optimistic-lock="false"
                  unique="false"/>
    </class>

</hibernate-mapping>